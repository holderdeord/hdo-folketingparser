#!/bin/sh
set -e

# Uses tools from the poppler-utils debian package
extract_interests() {
  URLPATH='www.stortinget.no/globalassets/pdf/register-for-stortingsrepresentantenes-og-regjeringsmedlemmenes-verv-og-okonomiske-interesser.pdf'
  mkdir -p "$(dirname $URLPATH)"
  GET https://$URLPATH > $URLPATH.new && mv $URLPATH.new $URLPATH
  pdftohtml -xml $URLPATH
  pdftotext $URLPATH
}

attendence() {
  URLPATH=www.stortinget.no/no/Representanter-og-komiteer/Representantene/Representantfordeling/
  GET https://$URLPATH > ${URLPATH}index.html
}
commit() {
  git commit -m "Inn med web page data fra $today." www.stortinget.no
}
today=$(date +%Y-%m-%d)
attendence && commit
extract_interests && commit
